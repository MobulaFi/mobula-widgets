{"id":"O093","dependencies":[{"name":"C:\\Users\\Veeno\\Desktop\\fse\\react-widget\\package.json","includedInParent":true,"mtime":1662044502394},{"name":"C:\\Users\\Veeno\\Desktop\\fse\\react-widget\\node_modules\\@supabase\\gotrue-js\\package.json","includedInParent":true,"mtime":1661947879682},{"name":"./lib/fetch","loc":{"line":10,"column":39},"parent":"C:\\Users\\Veeno\\Desktop\\fse\\react-widget\\node_modules\\@supabase\\gotrue-js\\dist\\module\\GoTrueApi.js","resolved":"C:\\Users\\Veeno\\Desktop\\fse\\react-widget\\node_modules\\@supabase\\gotrue-js\\dist\\module\\lib\\fetch.js"},{"name":"./lib/constants","loc":{"line":11,"column":31},"parent":"C:\\Users\\Veeno\\Desktop\\fse\\react-widget\\node_modules\\@supabase\\gotrue-js\\dist\\module\\GoTrueApi.js","resolved":"C:\\Users\\Veeno\\Desktop\\fse\\react-widget\\node_modules\\@supabase\\gotrue-js\\dist\\module\\lib\\constants.js"},{"name":"./lib/cookies","loc":{"line":12,"column":44},"parent":"C:\\Users\\Veeno\\Desktop\\fse\\react-widget\\node_modules\\@supabase\\gotrue-js\\dist\\module\\GoTrueApi.js","resolved":"C:\\Users\\Veeno\\Desktop\\fse\\react-widget\\node_modules\\@supabase\\gotrue-js\\dist\\module\\lib\\cookies.js"},{"name":"./lib/helpers","loc":{"line":13,"column":40},"parent":"C:\\Users\\Veeno\\Desktop\\fse\\react-widget\\node_modules\\@supabase\\gotrue-js\\dist\\module\\GoTrueApi.js","resolved":"C:\\Users\\Veeno\\Desktop\\fse\\react-widget\\node_modules\\@supabase\\gotrue-js\\dist\\module\\lib\\helpers.js"}],"generated":{"js":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:!0}),exports.default=void 0;var e=require(\"./lib/fetch\"),t=require(\"./lib/constants\"),r=require(\"./lib/cookies\"),s=require(\"./lib/helpers\"),i=function(e,t,r,s){return new(r||(r=Promise))(function(i,o){function n(e){try{c(s.next(e))}catch(t){o(t)}}function a(e){try{c(s.throw(e))}catch(t){o(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(n,a)}c((s=s.apply(e,t||[])).next())})};class o{constructor({url:e=\"\",headers:r={},cookieOptions:i,fetch:o}){this.url=e,this.headers=r,this.cookieOptions=Object.assign(Object.assign({},t.COOKIE_OPTIONS),i),this.fetch=(0,s.resolveFetch)(o)}_createRequestHeaders(e){const t=Object.assign({},this.headers);return t.Authorization=`Bearer ${e}`,t}cookieName(){var e;return null!==(e=this.cookieOptions.name)&&void 0!==e?e:\"\"}getUrlForProvider(e,t){const r=[`provider=${encodeURIComponent(e)}`];if((null==t?void 0:t.redirectTo)&&r.push(`redirect_to=${encodeURIComponent(t.redirectTo)}`),(null==t?void 0:t.scopes)&&r.push(`scopes=${encodeURIComponent(t.scopes)}`),null==t?void 0:t.queryParams){const e=new URLSearchParams(t.queryParams);r.push(`${e}`)}return`${this.url}/authorize?${r.join(\"&\")}`}signUpWithEmail(t,r,o={}){return i(this,void 0,void 0,function*(){try{const n=Object.assign({},this.headers);let a=\"\";o.redirectTo&&(a=\"?redirect_to=\"+encodeURIComponent(o.redirectTo));const c=yield(0,e.post)(this.fetch,`${this.url}/signup${a}`,{email:t,password:r,data:o.data,gotrue_meta_security:{captcha_token:o.captchaToken}},{headers:n}),u=Object.assign({},c);return u.expires_in&&(u.expires_at=(0,s.expiresAt)(c.expires_in)),{data:u,error:null}}catch(i){return{data:null,error:i}}})}signInWithEmail(t,r,o={}){return i(this,void 0,void 0,function*(){try{const n=Object.assign({},this.headers);let a=\"?grant_type=password\";o.redirectTo&&(a+=\"&redirect_to=\"+encodeURIComponent(o.redirectTo));const c=yield(0,e.post)(this.fetch,`${this.url}/token${a}`,{email:t,password:r,gotrue_meta_security:{captcha_token:o.captchaToken}},{headers:n}),u=Object.assign({},c);return u.expires_in&&(u.expires_at=(0,s.expiresAt)(c.expires_in)),{data:u,error:null}}catch(i){return{data:null,error:i}}})}signUpWithPhone(t,r,o={}){return i(this,void 0,void 0,function*(){try{const n=Object.assign({},this.headers),a=yield(0,e.post)(this.fetch,`${this.url}/signup`,{phone:t,password:r,data:o.data,gotrue_meta_security:{captcha_token:o.captchaToken}},{headers:n}),c=Object.assign({},a);return c.expires_in&&(c.expires_at=(0,s.expiresAt)(a.expires_in)),{data:c,error:null}}catch(i){return{data:null,error:i}}})}signInWithPhone(t,r,o={}){return i(this,void 0,void 0,function*(){try{const n=Object.assign({},this.headers),a=\"?grant_type=password\",c=yield(0,e.post)(this.fetch,`${this.url}/token${a}`,{phone:t,password:r,gotrue_meta_security:{captcha_token:o.captchaToken}},{headers:n}),u=Object.assign({},c);return u.expires_in&&(u.expires_at=(0,s.expiresAt)(c.expires_in)),{data:u,error:null}}catch(i){return{data:null,error:i}}})}signInWithOpenIDConnect({id_token:t,nonce:r,client_id:o,issuer:n,provider:a}){return i(this,void 0,void 0,function*(){try{const c=Object.assign({},this.headers),u=\"?grant_type=id_token\",h=yield(0,e.post)(this.fetch,`${this.url}/token${u}`,{id_token:t,nonce:r,client_id:o,issuer:n,provider:a},{headers:c}),d=Object.assign({},h);return d.expires_in&&(d.expires_at=(0,s.expiresAt)(h.expires_in)),{data:d,error:null}}catch(i){return{data:null,error:i}}})}sendMagicLinkEmail(t,r={}){var s;return i(this,void 0,void 0,function*(){try{const o=Object.assign({},this.headers);let n=\"\";r.redirectTo&&(n+=\"?redirect_to=\"+encodeURIComponent(r.redirectTo));const a=null===(s=r.shouldCreateUser)||void 0===s||s;return{data:yield(0,e.post)(this.fetch,`${this.url}/otp${n}`,{email:t,create_user:a,gotrue_meta_security:{captcha_token:r.captchaToken}},{headers:o}),error:null}}catch(i){return{data:null,error:i}}})}sendMobileOTP(t,r={}){var s;return i(this,void 0,void 0,function*(){try{const o=null===(s=r.shouldCreateUser)||void 0===s||s,n=Object.assign({},this.headers);return{data:yield(0,e.post)(this.fetch,`${this.url}/otp`,{phone:t,create_user:o,gotrue_meta_security:{captcha_token:r.captchaToken}},{headers:n}),error:null}}catch(i){return{data:null,error:i}}})}signOut(t){return i(this,void 0,void 0,function*(){try{return yield(0,e.post)(this.fetch,`${this.url}/logout`,{},{headers:this._createRequestHeaders(t),noResolveJson:!0}),{error:null}}catch(r){return{error:r}}})}verifyMobileOTP(t,r,o={}){return i(this,void 0,void 0,function*(){try{const n=Object.assign({},this.headers),a=yield(0,e.post)(this.fetch,`${this.url}/verify`,{phone:t,token:r,type:\"sms\",redirect_to:o.redirectTo},{headers:n}),c=Object.assign({},a);return c.expires_in&&(c.expires_at=(0,s.expiresAt)(a.expires_in)),{data:c,error:null}}catch(i){return{data:null,error:i}}})}verifyOTP({email:t,phone:r,token:o,type:n=\"sms\"},a={}){return i(this,void 0,void 0,function*(){try{const c=Object.assign({},this.headers),u=yield(0,e.post)(this.fetch,`${this.url}/verify`,{email:t,phone:r,token:o,type:n,redirect_to:a.redirectTo},{headers:c}),h=Object.assign({},u);return h.expires_in&&(h.expires_at=(0,s.expiresAt)(u.expires_in)),{data:h,error:null}}catch(i){return{data:null,error:i}}})}inviteUserByEmail(t,r={}){return i(this,void 0,void 0,function*(){try{const i=Object.assign({},this.headers);let o=\"\";return r.redirectTo&&(o+=\"?redirect_to=\"+encodeURIComponent(r.redirectTo)),{data:yield(0,e.post)(this.fetch,`${this.url}/invite${o}`,{email:t,data:r.data},{headers:i}),error:null}}catch(s){return{data:null,error:s}}})}resetPasswordForEmail(t,r={}){return i(this,void 0,void 0,function*(){try{const i=Object.assign({},this.headers);let o=\"\";return r.redirectTo&&(o+=\"?redirect_to=\"+encodeURIComponent(r.redirectTo)),{data:yield(0,e.post)(this.fetch,`${this.url}/recover${o}`,{email:t,gotrue_meta_security:{captcha_token:r.captchaToken}},{headers:i}),error:null}}catch(s){return{data:null,error:s}}})}refreshAccessToken(t){return i(this,void 0,void 0,function*(){try{const i=yield(0,e.post)(this.fetch,`${this.url}/token?grant_type=refresh_token`,{refresh_token:t},{headers:this.headers}),o=Object.assign({},i);return o.expires_in&&(o.expires_at=(0,s.expiresAt)(i.expires_in)),{data:o,error:null}}catch(r){return{data:null,error:r}}})}setAuthCookie(e,t){\"POST\"!==e.method&&(t.setHeader(\"Allow\",\"POST\"),t.status(405).end(\"Method Not Allowed\"));const{event:s,session:i}=e.body;if(!s)throw new Error(\"Auth event missing!\");if(\"SIGNED_IN\"===s){if(!i)throw new Error(\"Auth session missing!\");(0,r.setCookies)(e,t,[{key:\"access-token\",value:i.access_token},{key:\"refresh-token\",value:i.refresh_token}].map(e=>{var t;return{name:`${this.cookieName()}-${e.key}`,value:e.value,domain:this.cookieOptions.domain,maxAge:null!==(t=this.cookieOptions.lifetime)&&void 0!==t?t:0,path:this.cookieOptions.path,sameSite:this.cookieOptions.sameSite}}))}\"SIGNED_OUT\"===s&&(0,r.setCookies)(e,t,[\"access-token\",\"refresh-token\"].map(e=>({name:`${this.cookieName()}-${e}`,value:\"\",maxAge:-1}))),t.status(200).json({})}deleteAuthCookie(e,t,{redirectTo:s=\"/\"}){return(0,r.setCookies)(e,t,[\"access-token\",\"refresh-token\"].map(e=>({name:`${this.cookieName()}-${e}`,value:\"\",maxAge:-1}))),t.redirect(307,s)}getAuthCookieString(e,t){\"POST\"!==e.method&&(t.setHeader(\"Allow\",\"POST\"),t.status(405).end(\"Method Not Allowed\"));const{event:s,session:i}=e.body;if(!s)throw new Error(\"Auth event missing!\");if(\"SIGNED_IN\"===s){if(!i)throw new Error(\"Auth session missing!\");return(0,r.getCookieString)(e,t,[{key:\"access-token\",value:i.access_token},{key:\"refresh-token\",value:i.refresh_token}].map(e=>{var t;return{name:`${this.cookieName()}-${e.key}`,value:e.value,domain:this.cookieOptions.domain,maxAge:null!==(t=this.cookieOptions.lifetime)&&void 0!==t?t:0,path:this.cookieOptions.path,sameSite:this.cookieOptions.sameSite}}))}return\"SIGNED_OUT\"===s?(0,r.getCookieString)(e,t,[\"access-token\",\"refresh-token\"].map(e=>({name:`${this.cookieName()}-${e}`,value:\"\",maxAge:-1}))):t.getHeader(\"Set-Cookie\")}generateLink(t,r,s={}){return i(this,void 0,void 0,function*(){try{return{data:yield(0,e.post)(this.fetch,`${this.url}/admin/generate_link`,{type:t,email:r,password:s.password,data:s.data,redirect_to:s.redirectTo},{headers:this.headers}),error:null}}catch(i){return{data:null,error:i}}})}createUser(t){return i(this,void 0,void 0,function*(){try{const s=yield(0,e.post)(this.fetch,`${this.url}/admin/users`,t,{headers:this.headers});return{user:s,data:s,error:null}}catch(r){return{user:null,data:null,error:r}}})}listUsers(){return i(this,void 0,void 0,function*(){try{return{data:(yield(0,e.get)(this.fetch,`${this.url}/admin/users`,{headers:this.headers})).users,error:null}}catch(t){return{data:null,error:t}}})}getUserById(t){return i(this,void 0,void 0,function*(){try{return{data:yield(0,e.get)(this.fetch,`${this.url}/admin/users/${t}`,{headers:this.headers}),error:null}}catch(r){return{data:null,error:r}}})}getUserByCookie(e,t){return i(this,void 0,void 0,function*(){try{if(!e.cookies)throw new Error(\"Not able to parse cookies! When using Express make sure the cookie-parser middleware is in use!\");const i=e.cookies[`${this.cookieName()}-access-token`],o=e.cookies[`${this.cookieName()}-refresh-token`];if(!i)throw new Error(\"No cookie found!\");const{user:n,error:a}=yield this.getUser(i);if(a){if(!o)throw new Error(\"No refresh_token cookie found!\");if(!t)throw new Error(\"You need to pass the res object to automatically refresh the session!\");const{data:s,error:i}=yield this.refreshAccessToken(o);if(i)throw i;if(s)return(0,r.setCookies)(e,t,[{key:\"access-token\",value:s.access_token},{key:\"refresh-token\",value:s.refresh_token}].map(e=>{var t;return{name:`${this.cookieName()}-${e.key}`,value:e.value,domain:this.cookieOptions.domain,maxAge:null!==(t=this.cookieOptions.lifetime)&&void 0!==t?t:0,path:this.cookieOptions.path,sameSite:this.cookieOptions.sameSite}})),{token:s.access_token,user:s.user,data:s.user,error:null}}return{token:i,user:n,data:n,error:null}}catch(s){return{token:null,user:null,data:null,error:s}}})}updateUserById(t,r){return i(this,void 0,void 0,function*(){try{const i=yield(0,e.put)(this.fetch,`${this.url}/admin/users/${t}`,r,{headers:this.headers});return{user:i,data:i,error:null}}catch(s){return{user:null,data:null,error:s}}})}deleteUser(t){return i(this,void 0,void 0,function*(){try{const s=yield(0,e.remove)(this.fetch,`${this.url}/admin/users/${t}`,{},{headers:this.headers});return{user:s,data:s,error:null}}catch(r){return{user:null,data:null,error:r}}})}getUser(t){return i(this,void 0,void 0,function*(){try{const s=yield(0,e.get)(this.fetch,`${this.url}/user`,{headers:this._createRequestHeaders(t)});return{user:s,data:s,error:null}}catch(r){return{user:null,data:null,error:r}}})}updateUser(t,r){return i(this,void 0,void 0,function*(){try{const i=yield(0,e.put)(this.fetch,`${this.url}/user`,r,{headers:this._createRequestHeaders(t)});return{user:i,data:i,error:null}}catch(s){return{user:null,data:null,error:s}}})}}exports.default=o;"},"sourceMaps":null,"error":null,"hash":"23ee857f9792a437ed5792e111673fb4","cacheData":{"env":{}}}